Решение тестового задания kazanexpress.ru

Решение состоит из нескольких этапов:
1) Подготовка датасетов (playground_datasets.py):

   Сперва, для удобства создаётся train.parquet и test.parquet в csv формате. Затем отфильтровывается ненужная информация из поля **text_fields** и загружается в pro_train.csv и pro_test_csv.
2) Тренировка картиночной сети (**train_vgg16.py**):

   Я взял уже готовую нейронную сеть vgg16 и сделал через неё fine tune как из [примера](https://medium.com/@roshankg96/transfer-learning-and-fine-tuning-model-using-vgg-16-90b5401e1ebd) 
   
   К основной сети я добавил полносвязный слой размером 1024 **dense_6** чтобы увеличить емкость сети и чтобы потом взять эмбеддинги с этого слоя 
   
3) Получение эмбеддингов  картинок из вышеназванной сети (**generate_embeddings.py**, функция **generate_image_embs**):

   Для получения векторных представлений картинок я прогнал картинки через сеть и взял ембеддинги с предпоследнего слоя (**dense_6**). 
4) Тренировка текстовой сети (**train_distilbert.py**):

   Аналогично с первым пунктом, я решил сделать fine tune на предобученной модели [distilbert-base-multilingual-cased](https://huggingface.co/distilbert-base-multilingual-cased).
   
5) Получение эмбеддингов из текстовой сети (**generate_embeddings.py**, функция **generate_text_embs**):

   Для оптимизации затрачиваемого времени эмбеддинги получаются сразу по 8 штук в функции **generate_embeddings_on_batch()**.
6) Обучение логистической многоклассовой регрессии на полученных эмбеддингах (**logistical_regression.py**, функция **train**):

   В качестве датасета берутся ембеддинги картинок и текста и затем склеиваются в один датасет. При этом для нормализации картиночных эмбеддингов пришлось использовать **StandardScaler**. Это происходит в функции **get_dataset**. Далее происходит обучение многоклассовой логистической регрессии.
   
7) Получение предсказаний для тестового датасета из обученной регрессии (**logistical_regression.py**, функция **predict**):

   Данные из тестового датасета обрабатываются аналогично тренировочным и подаются на вход обученной модели регрессии. Предсказания записываются в результирующий файл.